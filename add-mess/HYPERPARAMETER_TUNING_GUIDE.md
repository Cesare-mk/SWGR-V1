# ActionPiece è¶…å‚æ•°è°ƒä¼˜æŒ‡å—

## ğŸ“‹ å½“å‰åŸºçº¿é…ç½®

```bash
# åŸºçº¿ç»“æœ (3ä¸ªseedå¹³å‡)
NDCG@5:  0.03571
NDCG@10: 0.04413
Recall@5: 0.05268
Recall@10: 0.07893

# å‘½ä»¤
for seed in {2026..2028}; do
    CUDA_VISIBLE_DEVICES=0 python3 main.py \
        --category=Beauty \
        --rand_seed=${seed} \
        --weight_decay=0.15 \
        --lr=0.001 \
        --n_hash_buckets=64
done
```

## ğŸ¯ è°ƒå‚å®éªŒè®¡åˆ’

### é˜¶æ®µ1ï¼šRanking Temperature è°ƒä¼˜ (æœ€é«˜ä¼˜å…ˆçº§)
**ç›®æ ‡**ï¼šæ‰¾åˆ°æœ€ä¼˜çš„ranking-guided lossæ¸©åº¦å‚æ•°

```bash
# å®éªŒ1.1: Ï„ = 0.5 (æ›´é™¡å³­ï¼Œæ›´å¼ºhard-negativeæƒ©ç½š)
# ä¿®æ”¹ config.yaml: ranking_temperature: 0.5
for seed in {2026..2028}; do
    CUDA_VISIBLE_DEVICES=0 python3 main.py \
        --category=Beauty \
        --rand_seed=${seed} \
        --weight_decay=0.15 \
        --lr=0.001 \
        --n_hash_buckets=64
done

# å®éªŒ1.2: Ï„ = 0.6
# ä¿®æ”¹ config.yaml: ranking_temperature: 0.6

# å®éªŒ1.3: Ï„ = 0.8
# ä¿®æ”¹ config.yaml: ranking_temperature: 0.8

# å®éªŒ1.4: Ï„ = 1.0 (æ ‡å‡†CE lossï¼Œä½œä¸ºå¯¹ç…§)
# ä¿®æ”¹ config.yaml: ranking_temperature: 1.0
```

**æœŸæœ›æ•ˆæœ**ï¼š
- Ï„ < 0.7: å¯èƒ½è¿›ä¸€æ­¥æå‡NDCGï¼ˆæ›´å…³æ³¨æ’åºè´¨é‡ï¼‰
- Ï„ = 1.0: åº”è¯¥æ¥è¿‘æˆ–ç•¥ä½äºå½“å‰ç»“æœ

---

### é˜¶æ®µ2ï¼šGamma å€¼å¾®è°ƒ
**ç›®æ ‡**ï¼šä¼˜åŒ–è¯­ä¹‰æƒé‡çš„å½±å“å¼ºåº¦

å½“å‰ Î³=3.0ï¼Œæƒé‡å› å­èŒƒå›´ [0.2196, 7.3891]

```bash
# å®éªŒ2.1: Î³ = 2.5 (å‡å¼±æƒé‡å½±å“)
# ä¿®æ”¹ config.yaml: item_weight_gamma: 2.5
for seed in {2026..2028}; do
    CUDA_VISIBLE_DEVICES=0 python3 main.py \
        --category=Beauty \
        --rand_seed=${seed} \
        --weight_decay=0.15 \
        --lr=0.001 \
        --n_hash_buckets=64
done

# å®éªŒ2.2: Î³ = 3.5 (å¢å¼ºæƒé‡å½±å“)
# ä¿®æ”¹ config.yaml: item_weight_gamma: 3.5

# å®éªŒ2.3: Î³ = 4.0 (æ›´å¼ºå½±å“)
# ä¿®æ”¹ config.yaml: item_weight_gamma: 4.0
```

**æ£€æŸ¥è¯æ±‡è¡¨æ—¥å¿—**ï¼š
- æƒé‡è´¡çŒ®åº¦åº”åœ¨ 0.15-0.30 ä¹‹é—´
- æ˜¾è‘—åŠ æƒæ¯”ä¾‹ < 3%

---

### é˜¶æ®µ3ï¼šé›†æˆæ¨ç†è§„æ¨¡è°ƒæ•´
**ç›®æ ‡**ï¼šå¹³è¡¡æ¨ç†æˆæœ¬å’Œæ€§èƒ½

å½“å‰ n_inference_ensemble=5

```bash
# å®éªŒ3.1: n_ensemble = 3 (é™ä½è®¡ç®—æˆæœ¬)
# ä¿®æ”¹ config.yaml: n_inference_ensemble: 3
for seed in {2026..2028}; do
    CUDA_VISIBLE_DEVICES=0 python3 main.py \
        --category=Beauty \
        --rand_seed=${seed} \
        --weight_decay=0.15 \
        --lr=0.001 \
        --n_hash_buckets=64
done

# å®éªŒ3.2: n_ensemble = 7 (å¯èƒ½æœ‰è¾¹é™…æ”¶ç›Š)
# ä¿®æ”¹ config.yaml: n_inference_ensemble: 7
```

**æœŸæœ›**ï¼š5å¯èƒ½å·²æ¥è¿‘æœ€ä¼˜ï¼Œä½†å€¼å¾—éªŒè¯

---

### é˜¶æ®µ4ï¼šå­¦ä¹ ç‡å’Œæ­£åˆ™åŒ–ç»„åˆ
**ç›®æ ‡**ï¼šå¯»æ‰¾æ›´å¥½çš„ä¼˜åŒ–è½¨è¿¹

```bash
# å®éªŒ4.1: é™ä½å­¦ä¹ ç‡ + é™ä½weight_decay
for seed in {2026..2028}; do
    CUDA_VISIBLE_DEVICES=0 python3 main.py \
        --category=Beauty \
        --rand_seed=${seed} \
        --weight_decay=0.10 \
        --lr=0.0008 \
        --n_hash_buckets=64
done

# å®éªŒ4.2: æé«˜å­¦ä¹ ç‡ + æé«˜weight_decay
for seed in {2026..2028}; do
    CUDA_VISIBLE_DEVICES=0 python3 main.py \
        --category=Beauty \
        --rand_seed=${seed} \
        --weight_decay=0.20 \
        --lr=0.0012 \
        --n_hash_buckets=64
done
```

---

### é˜¶æ®µ5ï¼šæƒé‡è£å‰ªèŒƒå›´è°ƒæ•´ (è°¨æ…å®éªŒ)
**ç›®æ ‡**ï¼šæ§åˆ¶æç«¯æƒé‡çš„å½±å“

å½“å‰ [0.2, 4.0]ï¼Œå¯¹åº”æƒé‡å› å­æœ€å¤§èŒƒå›´ [0.22, 7.39]

```bash
# å®éªŒ5.1: æ›´ä¿å®ˆçš„è£å‰ª [0.3, 3.0]
# ä¿®æ”¹ config.yaml: item_weight_clip_range: [0.3, 3.0]
for seed in {2026..2028}; do
    CUDA_VISIBLE_DEVICES=0 python3 main.py \
        --category=Beauty \
        --rand_seed=${seed} \
        --weight_decay=0.15 \
        --lr=0.001 \
        --n_hash_buckets=64
done

# å®éªŒ5.2: æ›´æ¿€è¿›çš„æƒé‡ [0.2, 5.0]
# ä¿®æ”¹ config.yaml: item_weight_clip_range: [0.2, 5.0]
```

**æ³¨æ„**ï¼šæ¯æ¬¡ä¿®æ”¹åéœ€é‡æ–°æ„å»ºè¯æ±‡è¡¨

---

## ğŸ“Š å®éªŒè®°å½•æ¨¡æ¿

```markdown
### å®éªŒ X.Y: [å®éªŒåç§°]

**é…ç½®å˜æ›´**ï¼š
- å‚æ•°1: æ—§å€¼ â†’ æ–°å€¼
- å‚æ•°2: æ—§å€¼ â†’ æ–°å€¼

**è¯æ±‡è¡¨ç»Ÿè®¡** (å¦‚æœ‰é‡å»º):
- æƒé‡è´¡çŒ®åº¦: X.XXX
- æƒé‡æ ‡å‡†å·®: X.XXX
- Top-20æ’åºå˜åŒ–: XX.X%

**æ€§èƒ½æŒ‡æ ‡** (3 seeds å¹³å‡):
| Metric     | Seed2026 | Seed2027 | Seed2028 | **å¹³å‡** | vsåŸºçº¿ |
|------------|----------|----------|----------|----------|--------|
| NDCG@5     |          |          |          |          |        |
| NDCG@10    |          |          |          |          |        |
| Recall@5   |          |          |          |          |        |
| Recall@10  |          |          |          |          |        |

**ç»“è®º**ï¼š
- [ ] æå‡ / [ ] æŒå¹³ / [ ] ä¸‹é™
- è§‚å¯Ÿåˆ°çš„ç°è±¡ï¼š...
```

---

## ğŸ”¬ è°ƒå‚ç»éªŒæ³•åˆ™

1. **Ranking Temperature (Ï„)**ï¼š
   - è®ºæ–‡é€šå¸¸ä½¿ç”¨ 0.5-1.0
   - Ï„â†“ â†’ å¢å¼ºæ’åºèƒ½åŠ›ï¼Œä½†å¯èƒ½è¿‡æ‹Ÿåˆ
   - ä¼˜å…ˆæµ‹è¯• [0.5, 0.6, 0.7, 0.8]

2. **Gamma (Î³)**ï¼š
   - å½“å‰ Î³=3.0 è¡¨ç°è‰¯å¥½
   - è§‚å¯Ÿæƒé‡è´¡çŒ®åº¦ï¼Œä¿æŒåœ¨ 0.15-0.30
   - æ­¥é•¿ 0.5 å³å¯

3. **Ensemble Size**ï¼š
   - è¾¹é™…æ”¶ç›Šé€’å‡ï¼Œ5å¯èƒ½å·²æ¥è¿‘é¥±å’Œ
   - 3ã€5ã€7 ä¸‰æ¡£éªŒè¯å³å¯

4. **Learning Rate & Weight Decay**ï¼š
   - å®ƒä»¬å…±åŒå½±å“æ³›åŒ–èƒ½åŠ›
   - éœ€è¦ç½‘æ ¼æœç´¢æˆ–æˆå¯¹è°ƒæ•´

---

## âš ï¸ é‡è¦æé†’

1. **æ¯æ¬¡ä¿®æ”¹æƒé‡ç›¸å…³å‚æ•°å**ï¼ˆgammaã€clip_rangeï¼‰ï¼Œå¿…é¡»ï¼š
   ```bash
   rm -rf cache/AmazonReviews2014/Beauty/processed/actionpiece.json
   ```
   é‡æ–°æ„å»ºè¯æ±‡è¡¨

2. **æ¯ä¸ªå®éªŒè‡³å°‘è·‘3ä¸ªseeds**ï¼ŒæŠ¥å‘Šå¹³å‡å€¼å’Œæ ‡å‡†å·®

3. **è®°å½•å®Œæ•´æ—¥å¿—**ï¼ŒåŒ…æ‹¬è¯æ±‡è¡¨æ„å»ºé˜¶æ®µçš„æƒé‡åˆ†æ

4. **é€æ­¥å®éªŒ**ï¼Œä¸è¦åŒæ—¶æ”¹å¤šä¸ªå‚æ•°

---

## ğŸ¯ é¢„æœŸæ—¶é—´ä¼°ç®—

å‡è®¾æ¯æ¬¡è®­ç»ƒçº¦30åˆ†é’Ÿï¼ˆBeautyæ•°æ®é›† + 3 seedsï¼‰ï¼š

- é˜¶æ®µ1 (4ç»„å®éªŒ): ~2å°æ—¶
- é˜¶æ®µ2 (3ç»„å®éªŒ): ~1.5å°æ—¶
- é˜¶æ®µ3 (2ç»„å®éªŒ): ~1å°æ—¶
- é˜¶æ®µ4 (2ç»„å®éªŒ): ~1å°æ—¶
- é˜¶æ®µ5 (2ç»„å®éªŒ): ~1å°æ—¶ (éœ€é‡å»ºè¯æ±‡è¡¨)

**æ€»è®¡çº¦ 6.5å°æ—¶**

---

## ğŸ“ˆ ä½•æ—¶åœæ­¢è°ƒå‚ï¼Œè½¬å‘ä»£ç ä¼˜åŒ–ï¼Ÿ

æ»¡è¶³ä»¥ä¸‹ä»»ä¸€æ¡ä»¶æ—¶ï¼Œè€ƒè™‘ä»£ç å±‚é¢ä¼˜åŒ–ï¼š

1. **æ€§èƒ½åœæ»**ï¼šè¿ç»­3ç»„å®éªŒæ— æ˜æ˜¾æå‡ï¼ˆ<1%ï¼‰
2. **è¶…å‚æ•°æ•æ„Ÿ**ï¼šæŒ‡æ ‡éšå‚æ•°å‰§çƒˆæ³¢åŠ¨ï¼ˆæ–¹å·®>0.002ï¼‰
3. **è¾¾åˆ°é¢„æœŸç›®æ ‡**ï¼šNDCG@10 > 0.045 æˆ– ç›¸å¯¹åŸæ–‡æå‡ > 5%
4. **å·²ç©·å°½ä¸»è¦è¶…å‚æ•°**ï¼šå®Œæˆä¸Šè¿°5ä¸ªé˜¶æ®µ

---

## ğŸ’¡ åç»­ä»£ç ä¼˜åŒ–æ–¹å‘ï¼ˆå¤‡é€‰ï¼‰

å¦‚æœè°ƒå‚åä»æœ‰æå‡ç©ºé—´ï¼Œå¯è€ƒè™‘ï¼š

1. **æ›´ç²¾ç»†çš„è¯­ä¹‰æƒé‡ç­–ç•¥**ï¼š
   - ç±»åˆ«çº§åˆ«çš„è‡ªé€‚åº”gamma
   - å¤šå°ºåº¦è¯­ä¹‰ç›¸ä¼¼åº¦ï¼ˆä¸åŒåµŒå…¥æ¨¡å‹èåˆï¼‰

2. **æ”¹è¿›Beam Search**ï¼š
   - é•¿åº¦æƒ©ç½š (length penalty)
   - å¤šæ ·æ€§beam search (diverse beam search)

3. **æŸå¤±å‡½æ•°å¢å¼º**ï¼š
   - Contrastive learning è¾…åŠ©ä»»åŠ¡
   - çŸ¥è¯†è’¸é¦ (ä»æ›´å¤§æ¨¡å‹)

4. **æ•°æ®å¢å¼º**ï¼š
   - æ›´æ¿€è¿›çš„éšæœºæ¸¸èµ°ç­–ç•¥
   - åäº‹å®æ•°æ®å¢å¼º

ä½†**å¼ºçƒˆå»ºè®®å…ˆå®Œæˆè°ƒå‚å®éªŒ**ï¼

